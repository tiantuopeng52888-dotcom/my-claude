<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Nova å†…å®¹ç®¡ç†ç³»ç»Ÿ</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet" />
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    :root {
      --bg:       #0a0404;
      --surface:  #110707;
      --surface2: #1a0a0a;
      --border:   #2a1313;
      --border2:  #3a1a1a;
      --text:     #f0e6e6;
      --muted:    #8a7373;
      --red:      #dc2626;
      --red-dark: #991b1b;
      --gold:     #f59e0b;
      --white:    #ffffff;
      --sidebar:  200px;
      --header:   60px;
      --radius:   10px;
    }
    html, body { height: 100%; }
    body { font-family: 'Inter', system-ui, sans-serif; background: var(--bg); color: var(--text); font-size: 14px; line-height: 1.5; }
    a { color: inherit; text-decoration: none; }
    input, textarea, select { font-family: inherit; font-size: 13px; }

    /* â”€â”€ Login â”€â”€ */
    #loginScreen {
      position: fixed; inset: 0; z-index: 999;
      background: var(--bg);
      display: flex; align-items: center; justify-content: center;
    }
    .login-card {
      width: 380px; padding: 48px 40px;
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 16px;
      text-align: center;
    }
    .login-logo {
      display: inline-flex; align-items: center; gap: 10px;
      font-size: 22px; font-weight: 800; color: var(--white); margin-bottom: 8px;
    }
    .login-logo-mark {
      width: 36px; height: 36px;
      background: linear-gradient(135deg, var(--red), var(--gold));
      border-radius: 8px; display: grid; place-items: center;
      font-size: 18px; font-weight: 800; color: white;
    }
    .login-sub { font-size: 13px; color: var(--muted); margin-bottom: 36px; }
    .login-label { display: block; text-align: left; font-size: 12px; font-weight: 600; color: var(--muted); margin-bottom: 6px; }
    .login-input {
      width: 100%; padding: 11px 14px;
      background: var(--bg); border: 1px solid var(--border2);
      border-radius: 8px; color: var(--text); outline: none;
      transition: border-color 0.2s;
    }
    .login-input:focus { border-color: var(--red); }
    .login-btn {
      width: 100%; margin-top: 16px; padding: 12px;
      background: linear-gradient(135deg, var(--red), var(--red-dark));
      color: white; border: none; border-radius: 8px;
      font-size: 14px; font-weight: 700; cursor: pointer;
      transition: opacity 0.2s, transform 0.2s;
    }
    .login-btn:hover { opacity: 0.9; transform: translateY(-1px); }
    .login-error { color: #f87171; font-size: 12px; margin-top: 10px; display: none; }
    .login-hint { font-size: 11px; color: var(--border2); margin-top: 24px; }
    .login-hint span { color: var(--muted); }

    /* â”€â”€ App Shell â”€â”€ */
    #cmsApp { display: none; height: 100vh; overflow: hidden; }
    .app { display: flex; height: 100%; }

    /* â”€â”€ Sidebar â”€â”€ */
    .sidebar {
      width: var(--sidebar); flex-shrink: 0;
      background: var(--surface);
      border-right: 1px solid var(--border);
      display: flex; flex-direction: column;
      overflow-y: auto;
    }
    .sidebar-logo {
      padding: 20px 16px 16px;
      display: flex; align-items: center; gap: 8px;
      font-size: 16px; font-weight: 800; color: var(--white);
      border-bottom: 1px solid var(--border);
    }
    .sidebar-logo-mark {
      width: 28px; height: 28px;
      background: linear-gradient(135deg, var(--red), var(--gold));
      border-radius: 6px; display: grid; place-items: center;
      font-size: 13px; font-weight: 800; color: white; flex-shrink: 0;
    }
    .sidebar-logo-sub { font-size: 10px; font-weight: 400; color: var(--muted); display: block; line-height: 1; }
    .nav-group { padding: 12px 8px 4px; }
    .nav-group-label { font-size: 10px; font-weight: 700; color: var(--muted); text-transform: uppercase; letter-spacing: 0.08em; padding: 0 8px; margin-bottom: 4px; }
    .nav-item {
      display: flex; align-items: center; gap: 8px;
      padding: 8px 10px; border-radius: 7px; cursor: pointer;
      color: var(--muted); font-size: 13px; font-weight: 500;
      transition: all 0.15s; margin-bottom: 1px;
    }
    .nav-item:hover { background: var(--surface2); color: var(--text); }
    .nav-item.active { background: rgba(220,38,38,0.12); color: var(--red); font-weight: 600; }
    .nav-icon { font-size: 14px; width: 18px; text-align: center; flex-shrink: 0; }
    .sidebar-footer {
      margin-top: auto; padding: 12px 8px;
      border-top: 1px solid var(--border);
    }
    .logout-btn {
      width: 100%; padding: 8px 10px; border-radius: 7px;
      background: none; border: none; cursor: pointer;
      color: var(--muted); font-size: 13px; font-weight: 500;
      display: flex; align-items: center; gap: 8px;
      transition: all 0.15s;
    }
    .logout-btn:hover { color: #f87171; background: rgba(220,38,38,0.08); }

    /* â”€â”€ Main â”€â”€ */
    .main { flex: 1; display: flex; flex-direction: column; overflow: hidden; }
    .cms-header {
      height: var(--header); flex-shrink: 0;
      background: var(--surface); border-bottom: 1px solid var(--border);
      display: flex; align-items: center; justify-content: space-between;
      padding: 0 24px;
    }
    .cms-header-left { display: flex; align-items: center; gap: 12px; }
    .cms-header-title { font-size: 16px; font-weight: 700; color: var(--white); }
    .cms-header-desc { font-size: 12px; color: var(--muted); }
    .header-actions { display: flex; align-items: center; gap: 8px; }
    .hbtn {
      padding: 7px 14px; border-radius: 7px;
      font-size: 12px; font-weight: 600; cursor: pointer;
      border: none; transition: all 0.15s;
    }
    .hbtn-ghost {
      background: transparent; color: var(--muted);
      border: 1px solid var(--border2);
    }
    .hbtn-ghost:hover { color: var(--text); border-color: var(--muted); }
    .hbtn-primary {
      background: linear-gradient(135deg, var(--red), var(--red-dark));
      color: white;
    }
    .hbtn-primary:hover { opacity: 0.85; }

    .cms-body { flex: 1; overflow-y: auto; padding: 28px; }

    /* â”€â”€ Section â”€â”€ */
    .cms-section { display: none; max-width: 860px; }
    .cms-section.active { display: block; }

    /* â”€â”€ Dashboard â”€â”€ */
    .dash-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; margin-bottom: 28px; }
    .dash-card {
      padding: 20px; background: var(--surface);
      border: 1px solid var(--border); border-radius: var(--radius);
      cursor: pointer; transition: all 0.15s;
    }
    .dash-card:hover { border-color: var(--red); transform: translateY(-2px); }
    .dash-card-icon { font-size: 22px; margin-bottom: 10px; }
    .dash-card-title { font-size: 14px; font-weight: 700; color: var(--white); margin-bottom: 4px; }
    .dash-card-sub { font-size: 12px; color: var(--muted); }
    .dash-info {
      padding: 16px 20px;
      background: rgba(220,38,38,0.06);
      border: 1px solid rgba(220,38,38,0.2);
      border-radius: var(--radius);
      font-size: 13px; color: var(--muted); line-height: 1.7;
    }
    .dash-info strong { color: var(--gold); }

    /* â”€â”€ Form Cards â”€â”€ */
    .form-card {
      background: var(--surface); border: 1px solid var(--border);
      border-radius: var(--radius); padding: 24px; margin-bottom: 20px;
    }
    .form-card-title {
      font-size: 14px; font-weight: 700; color: var(--white);
      margin-bottom: 4px; display: flex; align-items: center; gap: 8px;
    }
    .form-card-title::before {
      content: ''; width: 3px; height: 16px;
      background: var(--red); border-radius: 2px; flex-shrink: 0;
    }
    .form-card-sub { font-size: 12px; color: var(--muted); margin-bottom: 20px; padding-left: 11px; }
    .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 14px; }
    .form-grid.cols-1 { grid-template-columns: 1fr; }
    .form-grid.cols-3 { grid-template-columns: 1fr 1fr 1fr; }
    .form-group { display: flex; flex-direction: column; gap: 5px; }
    .form-group.full { grid-column: 1 / -1; }
    label { font-size: 11px; font-weight: 600; color: var(--muted); text-transform: uppercase; letter-spacing: 0.05em; }
    input[type="text"], input[type="email"], input[type="tel"], input[type="number"], textarea, select {
      background: var(--bg); border: 1px solid var(--border2);
      border-radius: 7px; padding: 9px 12px; color: var(--text);
      outline: none; transition: border-color 0.2s; resize: vertical;
      width: 100%;
    }
    input:focus, textarea:focus, select:focus { border-color: var(--red); }
    textarea { min-height: 80px; line-height: 1.6; }
    .small-input { max-width: 80px; }

    /* Repeater cards (services, testimonials, work) */
    .repeater-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
    .repeater-item {
      background: var(--surface2); border: 1px solid var(--border);
      border-radius: var(--radius); padding: 16px;
    }
    .repeater-item-header {
      font-size: 12px; font-weight: 700; color: var(--gold);
      margin-bottom: 12px; display: flex; align-items: center; gap: 6px;
    }
    .repeater-item-header span {
      width: 20px; height: 20px; border-radius: 50%;
      background: rgba(245,158,11,0.15); display: grid; place-items: center;
      font-size: 10px; font-weight: 800;
    }
    .ri-fields { display: flex; flex-direction: column; gap: 10px; }

    /* Save row */
    .save-row {
      display: flex; align-items: center; gap: 12px; margin-top: 20px;
    }
    .save-btn {
      padding: 10px 24px; border-radius: 8px;
      background: linear-gradient(135deg, var(--red), var(--red-dark));
      color: white; font-size: 13px; font-weight: 700;
      border: none; cursor: pointer; transition: all 0.15s;
    }
    .save-btn:hover { opacity: 0.85; transform: translateY(-1px); }
    .save-msg { font-size: 12px; color: #4ade80; display: none; }
    .reset-link { font-size: 12px; color: var(--muted); cursor: pointer; margin-left: auto; }
    .reset-link:hover { color: #f87171; }

    /* Saved indicator */
    .save-msg.visible { display: inline; }

    /* Work CRUD */
    .work-add-btn {
      display: flex; align-items: center; justify-content: center; gap: 6px;
      width: 100%; margin-top: 14px; padding: 10px;
      background: rgba(220,38,38,0.07); border: 1px dashed rgba(220,38,38,0.35);
      border-radius: var(--radius); color: var(--red);
      font-size: 13px; font-weight: 600; cursor: pointer;
      transition: all 0.15s;
    }
    .work-add-btn:hover { background: rgba(220,38,38,0.15); border-style: solid; }
    .item-del-btn {
      margin-left: auto; padding: 2px 9px; border-radius: 5px;
      background: rgba(220,38,38,0.1); border: 1px solid rgba(220,38,38,0.25);
      color: #f87171; font-size: 11px; font-weight: 600; cursor: pointer;
      transition: all 0.15s; line-height: 1.6;
    }
    .item-del-btn:hover { background: rgba(220,38,38,0.25); color: #fff; }
  </style>
</head>
<body>

<!-- ===== LOGIN ===== -->
<div id="loginScreen">
  <div class="login-card">
    <div class="login-logo">
      <div class="login-logo-mark">N</div>
      <div>
        <div>Nova</div>
        <span class="sidebar-logo-sub">å†…å®¹ç®¡ç†ç³»ç»Ÿ</span>
      </div>
    </div>
    <p class="login-sub">è¯·è¾“å…¥ç®¡ç†å‘˜å¯†ç ä»¥ç»§ç»­</p>
    <label class="login-label" for="pwdInput">ç®¡ç†å‘˜å¯†ç </label>
    <input class="login-input" id="pwdInput" type="password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" autocomplete="current-password" />
    <button class="login-btn" id="loginBtn">ç™»å½•</button>
    <div class="login-error" id="loginError">å¯†ç é”™è¯¯ï¼Œè¯·é‡è¯•</div>
    <p class="login-hint">æç¤ºï¼šå¯†ç ä¸º <span>nova2026</span></p>
  </div>
</div>

<!-- ===== CMS APP ===== -->
<div id="cmsApp">
  <div class="app">

    <!-- Sidebar -->
    <aside class="sidebar">
      <div class="sidebar-logo">
        <div class="sidebar-logo-mark">N</div>
        <div>
          <div>Nova CMS</div>
          <span class="sidebar-logo-sub">å†…å®¹ç®¡ç†åå°</span>
        </div>
      </div>

      <div class="nav-group">
        <div class="nav-group-label">æ¦‚è§ˆ</div>
        <div class="nav-item active" data-section="dashboard">
          <span class="nav-icon">ğŸ </span> ä»ªè¡¨ç›˜
        </div>
      </div>

      <div class="nav-group">
        <div class="nav-group-label">é¡µé¢å†…å®¹</div>
        <div class="nav-item" data-section="nav">
          <span class="nav-icon">ğŸ”¤</span> å¯¼èˆªæ 
        </div>
        <div class="nav-item" data-section="hero">
          <span class="nav-icon">ğŸ¯</span> é¦–é¡µæ¨ªå¹…
        </div>
        <div class="nav-item" data-section="about">
          <span class="nav-icon">ğŸ‘¥</span> å…³äºæˆ‘ä»¬
        </div>
        <div class="nav-item" data-section="services">
          <span class="nav-icon">ğŸ”§</span> æœåŠ¡é¡¹ç›®
        </div>
        <div class="nav-item" data-section="work">
          <span class="nav-icon">ğŸ¨</span> ç²¾é€‰æ¡ˆä¾‹
        </div>
        <div class="nav-item" data-section="testimonials">
          <span class="nav-icon">â­</span> å®¢æˆ·å£ç¢‘
        </div>
        <div class="nav-item" data-section="cta">
          <span class="nav-icon">ğŸ“¢</span> CTA åŒºåŸŸ
        </div>
        <div class="nav-item" data-section="contact">
          <span class="nav-icon">ğŸ“</span> è”ç³»æ–¹å¼
        </div>
        <div class="nav-item" data-section="footer">
          <span class="nav-icon">ğŸ¦¶</span> é¡µè„šè®¾ç½®
        </div>
      </div>

      <div class="sidebar-footer">
        <button class="logout-btn" id="logoutBtn">
          <span class="nav-icon">ğŸšª</span> é€€å‡ºç™»å½•
        </button>
      </div>
    </aside>

    <!-- Main -->
    <div class="main">
      <header class="cms-header">
        <div class="cms-header-left">
          <div>
            <div class="cms-header-title" id="headerTitle">ä»ªè¡¨ç›˜</div>
            <div class="cms-header-desc" id="headerDesc">å†…å®¹æ€»è§ˆä¸å¿«é€Ÿæ“ä½œ</div>
          </div>
        </div>
        <div class="header-actions">
          <button class="hbtn hbtn-ghost" onclick="resetAll()">é‡ç½®å…¨éƒ¨å†…å®¹</button>
          <button class="hbtn hbtn-primary" onclick="window.open('index.html','_blank')">é¢„è§ˆç½‘ç«™ â†’</button>
        </div>
      </header>

      <div class="cms-body">

        <!-- DASHBOARD -->
        <div class="cms-section active" id="section-dashboard">
          <div class="dash-grid">
            <div class="dash-card" onclick="showSection('hero')">
              <div class="dash-card-icon">ğŸ¯</div>
              <div class="dash-card-title">é¦–é¡µæ¨ªå¹…</div>
              <div class="dash-card-sub">Badgeã€æ ‡é¢˜ã€å‰¯æ ‡é¢˜ã€ç»Ÿè®¡æ•°æ®</div>
            </div>
            <div class="dash-card" onclick="showSection('services')">
              <div class="dash-card-icon">ğŸ”§</div>
              <div class="dash-card-title">æœåŠ¡é¡¹ç›®</div>
              <div class="dash-card-sub">6 ä¸ªæœåŠ¡å¡ç‰‡å†…å®¹</div>
            </div>
            <div class="dash-card" onclick="showSection('testimonials')">
              <div class="dash-card-icon">â­</div>
              <div class="dash-card-title">å®¢æˆ·å£ç¢‘</div>
              <div class="dash-card-sub">3 æ¡å®¢æˆ·è¯„ä»·</div>
            </div>
            <div class="dash-card" onclick="showSection('work')">
              <div class="dash-card-icon">ğŸ¨</div>
              <div class="dash-card-title">ç²¾é€‰æ¡ˆä¾‹</div>
              <div class="dash-card-sub">3 ä¸ªä½œå“å±•ç¤º</div>
            </div>
            <div class="dash-card" onclick="showSection('contact')">
              <div class="dash-card-icon">ğŸ“</div>
              <div class="dash-card-title">è”ç³»æ–¹å¼</div>
              <div class="dash-card-sub">é‚®ç®±ã€ç”µè¯ã€åœ°å€</div>
            </div>
            <div class="dash-card" onclick="showSection('footer')">
              <div class="dash-card-icon">ğŸ¦¶</div>
              <div class="dash-card-title">é¡µè„šè®¾ç½®</div>
              <div class="dash-card-sub">å£å·ã€ç‰ˆæƒå¹´ä»½</div>
            </div>
          </div>
          <div class="dash-info">
            ğŸ’¡ <strong>ä½¿ç”¨è¯´æ˜ï¼š</strong>åœ¨å·¦ä¾§èœå•é€‰æ‹©è¦ç¼–è¾‘çš„å†…å®¹åŒºå—ï¼Œä¿®æ”¹åç‚¹å‡» <strong>ã€Œä¿å­˜ã€</strong> æŒ‰é’®ã€‚å†…å®¹ä¿å­˜åœ¨æµè§ˆå™¨æœ¬åœ°ï¼Œåˆ·æ–° <strong>ã€Œé¢„è§ˆç½‘ç«™ã€</strong> å³å¯çœ‹åˆ°å˜åŒ–ã€‚å¦‚éœ€æ¢å¤é»˜è®¤å†…å®¹ï¼Œç‚¹å‡»å³ä¸Šè§’ <strong>ã€Œé‡ç½®å…¨éƒ¨å†…å®¹ã€</strong>ã€‚
          </div>
        </div>

        <!-- NAV -->
        <div class="cms-section" id="section-nav">
          <div class="form-card">
            <div class="form-card-title">å¯¼èˆªæ è®¾ç½®</div>
            <div class="form-card-sub">å“ç‰Œåç§°ä¸ Logo æ ‡è®°</div>
            <div class="form-grid">
              <div class="form-group">
                <label>å“ç‰Œåç§°</label>
                <input type="text" id="nav-logo" placeholder="Nova" />
              </div>
              <div class="form-group">
                <label>Logo æ ‡è®°å­—æ¯</label>
                <input type="text" id="nav-logoMark" placeholder="N" maxlength="2" />
              </div>
            </div>
            <div class="save-row">
              <button class="save-btn" onclick="saveSection('nav')">ä¿å­˜å¯¼èˆªæ </button>
              <span class="save-msg" id="save-nav">âœ“ å·²ä¿å­˜</span>
            </div>
          </div>
        </div>

        <!-- HERO -->
        <div class="cms-section" id="section-hero">
          <div class="form-card">
            <div class="form-card-title">é¡¶éƒ¨å¾½ç« ä¸ä¸»æ ‡é¢˜</div>
            <div class="form-card-sub">é¦–å±æœ€æ˜¾çœ¼çš„åŒºåŸŸ</div>
            <div class="form-grid cols-1">
              <div class="form-group">
                <label>å¾½ç« æ–‡å­—ï¼ˆBadgeï¼‰</label>
                <input type="text" id="hero-badge" placeholder="ğŸŠ é©¬å¹´å¤§å‰ Â· 2026 æ–°æ˜¥çº³ç¦" />
              </div>
              <div class="form-group">
                <label>ä¸»æ ‡é¢˜ç¬¬ä¸€è¡Œ</label>
                <input type="text" id="hero-headline1" placeholder="ç”¨è®¾è®¡çš„åŠ›é‡" />
              </div>
              <div class="form-group">
                <label>ä¸»æ ‡é¢˜ç¬¬äºŒè¡Œï¼ˆæ¸å˜é«˜äº®ï¼‰</label>
                <input type="text" id="hero-headline2" placeholder="é‡å¡‘ä½ çš„å“ç‰Œ" />
              </div>
              <div class="form-group">
                <label>å‰¯æ ‡é¢˜è¯´æ˜æ–‡å­—</label>
                <textarea id="hero-sub" rows="2"></textarea>
              </div>
            </div>
            <div class="form-grid" style="margin-top:14px">
              <div class="form-group">
                <label>æŒ‰é’®ä¸€æ–‡å­—</label>
                <input type="text" id="hero-cta1" placeholder="å¼€å§‹åˆä½œ" />
              </div>
              <div class="form-group">
                <label>æŒ‰é’®äºŒæ–‡å­—</label>
                <input type="text" id="hero-cta2" placeholder="æŸ¥çœ‹æ¡ˆä¾‹ â†’" />
              </div>
            </div>
          </div>

          <div class="form-card">
            <div class="form-card-title">æ•°æ®ç»Ÿè®¡</div>
            <div class="form-card-sub">é¦–å±åº•éƒ¨ä¸‰ä¸ªæ•°å­—å¡ç‰‡</div>
            <div class="form-grid cols-3">
              <div class="form-group">
                <label>ç»Ÿè®¡ä¸€ æ•°å­—</label>
                <input type="number" id="hero-stat1Num" placeholder="200" />
              </div>
              <div class="form-group">
                <label>ç»Ÿè®¡ä¸€ å•ä½/æ ‡ç­¾</label>
                <input type="text" id="hero-stat1Sym" placeholder="+" />
              </div>
              <div class="form-group">
                <label>ç»Ÿè®¡ä¸€ è¯´æ˜</label>
                <input type="text" id="hero-stat1Label" placeholder="å“ç‰Œå®¢æˆ·" />
              </div>
              <div class="form-group">
                <label>ç»Ÿè®¡äºŒ æ•°å­—</label>
                <input type="number" id="hero-stat2Num" placeholder="98" />
              </div>
              <div class="form-group">
                <label>ç»Ÿè®¡äºŒ å•ä½/æ ‡ç­¾</label>
                <input type="text" id="hero-stat2Sym" placeholder="%" />
              </div>
              <div class="form-group">
                <label>ç»Ÿè®¡äºŒ è¯´æ˜</label>
                <input type="text" id="hero-stat2Label" placeholder="å®¢æˆ·æ»¡æ„ç‡" />
              </div>
              <div class="form-group">
                <label>ç»Ÿè®¡ä¸‰ æ•°å­—</label>
                <input type="number" id="hero-stat3Num" placeholder="8" />
              </div>
              <div class="form-group">
                <label>ç»Ÿè®¡ä¸‰ å•ä½/æ ‡ç­¾</label>
                <input type="text" id="hero-stat3Sym" placeholder="å¹´" />
              </div>
              <div class="form-group">
                <label>ç»Ÿè®¡ä¸‰ è¯´æ˜</label>
                <input type="text" id="hero-stat3Label" placeholder="è¡Œä¸šç»éªŒ" />
              </div>
            </div>
            <div class="save-row">
              <button class="save-btn" onclick="saveSection('hero')">ä¿å­˜é¦–é¡µæ¨ªå¹…</button>
              <span class="save-msg" id="save-hero">âœ“ å·²ä¿å­˜</span>
            </div>
          </div>
        </div>

        <!-- ABOUT -->
        <div class="cms-section" id="section-about">
          <div class="form-card">
            <div class="form-card-title">å…³äºæˆ‘ä»¬</div>
            <div class="form-card-sub">å…¬å¸ä»‹ç»åŒºåŸŸå†…å®¹</div>
            <div class="form-grid cols-1">
              <div class="form-group">
                <label>å¡ç‰‡æ ‡é¢˜</label>
                <input type="text" id="about-cardTitle" />
              </div>
              <div class="form-group">
                <label>å¡ç‰‡è¯´æ˜</label>
                <input type="text" id="about-cardText" />
              </div>
              <div class="form-group">
                <label>çªå‡ºå¹´æ•°ï¼ˆæ•°å­—ï¼‰</label>
                <input type="number" id="about-years" style="max-width:120px" />
              </div>
              <div class="form-group">
                <label>ç« èŠ‚æ ‡é¢˜ç¬¬ä¸€è¡Œ</label>
                <input type="text" id="about-title1" />
              </div>
              <div class="form-group">
                <label>ç« èŠ‚æ ‡é¢˜é«˜äº®è¯</label>
                <input type="text" id="about-title2" />
              </div>
              <div class="form-group">
                <label>æ­£æ–‡ç¬¬ä¸€æ®µ</label>
                <textarea id="about-body1" rows="3"></textarea>
              </div>
              <div class="form-group">
                <label>æ­£æ–‡ç¬¬äºŒæ®µ</label>
                <textarea id="about-body2" rows="3"></textarea>
              </div>
            </div>
            <div class="save-row">
              <button class="save-btn" onclick="saveSection('about')">ä¿å­˜å…³äºæˆ‘ä»¬</button>
              <span class="save-msg" id="save-about">âœ“ å·²ä¿å­˜</span>
            </div>
          </div>
        </div>

        <!-- SERVICES -->
        <div class="cms-section" id="section-services">
          <div class="form-card">
            <div class="form-card-title">æœåŠ¡é¡¹ç›®</div>
            <div class="form-card-sub">6 ä¸ªæœåŠ¡å¡ç‰‡</div>
            <div class="repeater-grid" id="services-repeater"></div>
            <div class="save-row">
              <button class="save-btn" onclick="saveSection('services')">ä¿å­˜æœåŠ¡é¡¹ç›®</button>
              <span class="save-msg" id="save-services">âœ“ å·²ä¿å­˜</span>
            </div>
          </div>
        </div>

        <!-- WORK -->
        <div class="cms-section" id="section-work">
          <div class="form-card">
            <div class="form-card-title">ç²¾é€‰æ¡ˆä¾‹</div>
            <div class="form-card-sub">ä½œå“å±•ç¤ºå¡ç‰‡ï¼ˆå¯æ–°å¢ã€ç¼–è¾‘ã€åˆ é™¤ï¼‰</div>
            <div id="work-repeater" style="display:flex;flex-direction:column;gap:14px;"></div>
            <button class="work-add-btn" onclick="addWorkItem()">ï¼‹ æ–°å¢æ¡ˆä¾‹</button>
            <div class="save-row">
              <button class="save-btn" onclick="saveSection('work')">ä¿å­˜ç²¾é€‰æ¡ˆä¾‹</button>
              <span class="save-msg" id="save-work">âœ“ å·²ä¿å­˜</span>
            </div>
          </div>
        </div>

        <!-- TESTIMONIALS -->
        <div class="cms-section" id="section-testimonials">
          <div class="form-card">
            <div class="form-card-title">å®¢æˆ·å£ç¢‘</div>
            <div class="form-card-sub">3 æ¡å®¢æˆ·è¯„ä»·</div>
            <div id="testimonials-repeater" style="display:flex;flex-direction:column;gap:14px;"></div>
            <div class="save-row">
              <button class="save-btn" onclick="saveSection('testimonials')">ä¿å­˜å®¢æˆ·å£ç¢‘</button>
              <span class="save-msg" id="save-testimonials">âœ“ å·²ä¿å­˜</span>
            </div>
          </div>
        </div>

        <!-- CTA -->
        <div class="cms-section" id="section-cta">
          <div class="form-card">
            <div class="form-card-title">CTA å·å¬åŒºåŸŸ</div>
            <div class="form-card-sub">é¡µé¢ä¸­é—´çš„æ·±è‰²å¬å”¤åŒºå—</div>
            <div class="form-grid cols-1">
              <div class="form-group">
                <label>å¤§æ ‡é¢˜</label>
                <input type="text" id="cta-title" />
              </div>
              <div class="form-group">
                <label>å‰¯æ ‡é¢˜</label>
                <input type="text" id="cta-sub" />
              </div>
              <div class="form-group">
                <label>æŒ‰é’®æ–‡å­—</label>
                <input type="text" id="cta-btn" />
              </div>
            </div>
            <div class="save-row">
              <button class="save-btn" onclick="saveSection('cta')">ä¿å­˜ CTA åŒºåŸŸ</button>
              <span class="save-msg" id="save-cta">âœ“ å·²ä¿å­˜</span>
            </div>
          </div>
        </div>

        <!-- CONTACT -->
        <div class="cms-section" id="section-contact">
          <div class="form-card">
            <div class="form-card-title">è”ç³»æ–¹å¼</div>
            <div class="form-card-sub">è”ç³»åŒºåŸŸæ˜¾ç¤ºçš„ä¿¡æ¯</div>
            <div class="form-grid cols-1">
              <div class="form-group">
                <label>è”ç³»æ ‡é¢˜</label>
                <input type="text" id="contact-title" />
              </div>
              <div class="form-group">
                <label>è”ç³»è¯´æ˜</label>
                <textarea id="contact-sub" rows="2"></textarea>
              </div>
              <div class="form-group">
                <label>ç”µå­é‚®ç®±</label>
                <input type="email" id="contact-email" />
              </div>
              <div class="form-group">
                <label>è”ç³»ç”µè¯</label>
                <input type="tel" id="contact-phone" />
              </div>
              <div class="form-group">
                <label>åŠå…¬åœ°å€</label>
                <input type="text" id="contact-address" />
              </div>
            </div>
            <div class="save-row">
              <button class="save-btn" onclick="saveSection('contact')">ä¿å­˜è”ç³»æ–¹å¼</button>
              <span class="save-msg" id="save-contact">âœ“ å·²ä¿å­˜</span>
            </div>
          </div>
        </div>

        <!-- FOOTER -->
        <div class="cms-section" id="section-footer">
          <div class="form-card">
            <div class="form-card-title">é¡µè„šè®¾ç½®</div>
            <div class="form-card-sub">åº•éƒ¨é¡µè„šæ–‡å­—ä¸ç‰ˆæƒä¿¡æ¯</div>
            <div class="form-grid cols-1">
              <div class="form-group">
                <label>å“ç‰Œå£å·ï¼ˆæ”¯æŒ &lt;br/&gt; æ¢è¡Œï¼‰</label>
                <textarea id="footer-tagline" rows="2"></textarea>
              </div>
              <div class="form-group">
                <label>ç‰ˆæƒå¹´ä»½</label>
                <input type="text" id="footer-year" style="max-width:120px" />
              </div>
              <div class="form-group">
                <label>ç‰ˆæƒä¸»ä½“åç§°</label>
                <input type="text" id="footer-company" />
              </div>
            </div>
            <div class="save-row">
              <button class="save-btn" onclick="saveSection('footer')">ä¿å­˜é¡µè„šè®¾ç½®</button>
              <span class="save-msg" id="save-footer">âœ“ å·²ä¿å­˜</span>
            </div>
          </div>
        </div>

      </div><!-- /cms-body -->
    </div><!-- /main -->
  </div><!-- /app -->
</div><!-- /cmsApp -->

<script>
'use strict';

/* â”€â”€ Supabase é…ç½®ï¼ˆå¡«å…¥ä½ è‡ªå·±çš„å€¼ï¼‰ â”€â”€ */
const SUPABASE_URL = 'https://ujerbbtirmforrynkrpo.supabase.co';
const SUPABASE_KEY = 'sb_publishable_QmyBWeu-VWKoGxjyzjNxtg_6XHzO13_';

/* â”€â”€ Constants â”€â”€ */
const STORAGE_KEY = 'nova_cms';
const AUTH_KEY    = 'nova_cms_auth';
const PASSWORD    = 'nova2026';

/* â”€â”€ Default Content â”€â”€ */
const DEFAULT = {
  nav: { logo: 'NOVA', logoMark: 'N' },
  hero: {
    badge: 'âœ¦ å“ç‰Œæˆ˜ç•¥ Â· è§†è§‰åˆ›æ–° Â· æ•°å­—ä½“éªŒ',
    headline1: 'ç”¨è®¾è®¡çš„åŠ›é‡',
    headline2: 'é‡å¡‘ä½ çš„å“ç‰Œ',
    sub: 'æˆ‘ä»¬æ˜¯ä¸€å®¶ä¸“æ³¨äºå“ç‰Œæˆ˜ç•¥ä¸è§†è§‰åˆ›æ–°çš„è®¾è®¡å…¬å¸ï¼Œå¸®åŠ©ä¼ä¸šå»ºç«‹ç‹¬ç‰¹çš„å“ç‰Œè¯†åˆ«ï¼Œèµ¢å¾—å¸‚åœºä¿¡ä»»ã€‚',
    cta1: 'å¼€å§‹åˆä½œ', cta2: 'æŸ¥çœ‹æ¡ˆä¾‹ â†’',
    stat1Num: 200, stat1Sym: '+', stat1Label: 'å“ç‰Œå®¢æˆ·',
    stat2Num: 98,  stat2Sym: '%', stat2Label: 'å®¢æˆ·æ»¡æ„ç‡',
    stat3Num: 8,   stat3Sym: 'å¹´', stat3Label: 'è¡Œä¸šç»éªŒ',
  },
  about: {
    cardTitle: 'ä»¥äººä¸ºæœ¬çš„è®¾è®¡å“²å­¦',
    cardText:  'æ¯ä¸€ä¸ªåƒç´ èƒŒåï¼Œéƒ½æ˜¯å¯¹ç”¨æˆ·ä½“éªŒçš„æ·±åˆ»ç†è§£ã€‚',
    years: 8,
    title1: 'æˆ‘ä»¬ä¸åªåšè®¾è®¡ï¼Œ',
    title2: 'å“ç‰Œç”Ÿå‘½åŠ›',
    body1: 'NOVA æˆç«‹äº 2017 å¹´ï¼Œç”±ä¸€ç¾¤çƒ­çˆ±è®¾è®¡ä¸æˆ˜ç•¥çš„åˆ›ä½œè€…å…±åŒåˆ›ç«‹ã€‚æˆ‘ä»¬æ·±ä¿¡ï¼Œå“è¶Šçš„å“ç‰Œä¸ä»…ä»…æ˜¯ç¾è§‚çš„è§†è§‰â€”â€”å®ƒæ˜¯æƒ…æ„Ÿã€æ•…äº‹ä¸ä»·å€¼è§‚çš„é›†åˆä½“ã€‚',
    body2: 'ä»åˆåˆ›å…¬å¸åˆ°è·¨å›½é›†å›¢ï¼Œæˆ‘ä»¬ä¸ºæ¯ä¸€ä½å®¢æˆ·æä¾›é‡èº«å®šåˆ¶çš„å“ç‰Œè§£å†³æ–¹æ¡ˆï¼Œè®©å“ç‰Œåœ¨ç«äº‰æ¿€çƒˆçš„å¸‚åœºä¸­è„±é¢–è€Œå‡ºã€‚',
  },
  services: [
    { icon: 'â—ˆ', title: 'å“ç‰Œæˆ˜ç•¥', desc: 'æ·±å…¥å¸‚åœºç ”ç©¶ï¼Œä¸ºå“ç‰Œåˆ¶å®šæ¸…æ™°çš„å®šä½ç­–ç•¥å’Œé•¿æœŸå‘å±•è·¯çº¿å›¾ã€‚' },
    { icon: 'â—‰', title: 'è§†è§‰è¯†åˆ«', desc: 'Logo è®¾è®¡ã€è‰²å½©ä½“ç³»ã€å­—ä½“è§„èŒƒï¼Œæ‰“é€ ä¸€è‡´ä¸”ä»¤äººéš¾å¿˜çš„è§†è§‰è¯­è¨€ã€‚' },
    { icon: 'â—†', title: 'æ•°å­—è®¾è®¡', desc: 'ç½‘ç«™ã€Appã€ç¤¾äº¤åª’ä½“ï¼Œä¸ºæ¯ä¸€ä¸ªæ•°å­—è§¦ç‚¹åˆ›é€ å“è¶Šçš„ç”¨æˆ·ä½“éªŒã€‚' },
    { icon: 'â—‡', title: 'å†…å®¹è¥é”€', desc: 'å“ç‰Œæ•…äº‹ã€æ–‡æ¡ˆåˆ›ä½œã€è§†é¢‘å†…å®¹ï¼Œè®©å“ç‰Œå£°éŸ³è§¦è¾¾ç›®æ ‡å—ä¼—çš„å†…å¿ƒã€‚' },
    { icon: 'â—‹', title: 'åŒ…è£…è®¾è®¡', desc: 'å°†å“ç‰Œä»·å€¼è½¬åŒ–ä¸ºå¯è§¦æ‘¸çš„äº§å“ä½“éªŒï¼Œä»è´§æ¶ä¸Šçš„ç¬¬ä¸€çœ¼å°±èµ¢å¾—æ¶ˆè´¹è€…ã€‚' },
    { icon: 'â–¡', title: 'å“ç‰Œå’¨è¯¢', desc: 'ä¸“ä¸šé¡¾é—®å›¢é˜Ÿï¼Œé™ªä¼´ä¼ä¸šåœ¨å“ç‰Œå»ºè®¾é“è·¯ä¸Šåšå‡ºæ­£ç¡®å†³ç­–ã€‚' },
  ],
  work: [
    { tag: 'å“ç‰Œé‡å¡‘', title: 'TechVision ç§‘æŠ€å“ç‰Œå‡çº§', desc: 'ä»ä¼ ç»Ÿç§‘æŠ€å…¬å¸åˆ°å‰æ²¿åˆ›æ–°å“ç‰Œçš„å…¨é¢èœ•å˜', image: 'https://picsum.photos/seed/techvision/1200/720' },
    { tag: 'è§†è§‰è¯†åˆ«', title: 'BrightCo å“ç‰Œç³»ç»Ÿ',       desc: 'æ„å»ºå®Œæ•´çš„è§†è§‰è¯†åˆ«ä½“ç³»',                 image: 'https://picsum.photos/seed/brightco/800/600' },
    { tag: 'æ•°å­—ä½“éªŒ', title: 'Luminary å®˜ç½‘è®¾è®¡',        desc: 'æ²‰æµ¸å¼å“ç‰Œæ•°å­—ä½“éªŒ',                     image: 'https://picsum.photos/seed/luminary/800/600' },
  ],
  testimonials: [
    { text: 'NOVA å›¢é˜Ÿå¯¹å“ç‰Œçš„ç†è§£è¶…å‡ºäº†æˆ‘ä»¬çš„æœŸæœ›ã€‚ä»–ä»¬ä¸ä»…ä»…äº¤ä»˜äº†ç¾ä¸½çš„è®¾è®¡ï¼Œæ›´ä¸ºæˆ‘ä»¬çš„å“ç‰Œæ³¨å…¥äº†çµé­‚ã€‚è‡ªä»å“ç‰Œå‡çº§åï¼Œæˆ‘ä»¬çš„å¸‚åœºè®¤çŸ¥åº¦æå‡äº†è¿‘ 60%ã€‚', author: 'ææ˜è¿œ', role: 'CEO, TechVision', initial: 'L' },
    { text: 'ä¸“ä¸šã€é«˜æ•ˆã€å¯Œæœ‰åˆ›é€ åŠ›ã€‚NOVA åœ¨æçŸ­çš„æ—¶é—´å†…å°±æŠ“ä½äº†æˆ‘ä»¬å“ç‰Œçš„ç²¾é«“ï¼Œäº¤ä»˜è´¨é‡ä»¤äººå°è±¡æ·±åˆ»ã€‚', author: 'Sarah Chen', role: 'CMO, BrightCo', initial: 'S' },
    { text: 'ä¸ NOVA åˆä½œæ˜¯æˆ‘ä»¬åšè¿‡çš„æœ€æ­£ç¡®çš„æŠ•èµ„ä¹‹ä¸€ã€‚ä»–ä»¬çš„æˆ˜ç•¥çœ¼å…‰å’Œæ‰§è¡ŒåŠ›éƒ½æ˜¯ä¸€æµçš„ã€‚', author: 'ç‹èŠ³', role: 'åˆ›å§‹äºº, Luminary', initial: 'W' },
  ],
  cta:     { title: 'å‡†å¤‡å¥½å¼€å§‹äº†å—ï¼Ÿ', sub: 'è®©æˆ‘ä»¬ä¸€èµ·æ‰“é€ è®©ä¸–ç•Œè®°ä½çš„å“ç‰Œã€‚', btn: 'å…è´¹å’¨è¯¢' },
  contact: { title: 'è®©æˆ‘ä»¬å¼€å§‹å¯¹è¯', sub: 'æ— è®ºæ‚¨æ˜¯åˆåˆ›å…¬å¸è¿˜æ˜¯æˆç†Ÿä¼ä¸šï¼Œæˆ‘ä»¬éƒ½å¾ˆä¹æ„äº†è§£æ‚¨çš„å“ç‰Œæ•…äº‹ï¼Œå¹¶æ¢è®¨å¦‚ä½•å¸®åŠ©æ‚¨å®ç°ç›®æ ‡ã€‚', email: 'hello@novabrand.com', phone: '+86 010-8888-8888', address: 'åŒ—äº¬å¸‚æœé˜³åŒºåˆ›æ„å¤§å¦ 18 å±‚' },
  footer:  { tagline: 'ç”¨è®¾è®¡é‡å¡‘ä¸–ç•Œï¼Œ<br/>ç”¨å“ç‰Œè¿æ¥æœªæ¥ã€‚', year: '2026', company: 'NOVA Brand' },
};

/* â”€â”€ Helpers â”€â”€ */
const $ = id => document.getElementById(id);
const val = id => { const el = $(id); return el ? el.value.trim() : ''; };
const setVal = (id, v) => { const el = $(id); if (el && v !== undefined && v !== null) el.value = v; };

/* å°† saved ä¸­å­˜åœ¨çš„ key åˆå¹¶è¿› defaultsï¼ˆæµ…åˆå¹¶ï¼Œä¿è¯æ‰€æœ‰å­—æ®µéƒ½æœ‰å€¼ï¼‰ */
function mergeWithDefault(defaults, saved) {
  const result = JSON.parse(JSON.stringify(defaults));
  for (const key of Object.keys(saved)) {
    if (key in result) result[key] = saved[key];
  }
  return result;
}

/* ä» Supabase åŠ è½½å†…å®¹ï¼Œå¤±è´¥åˆ™é™çº§åˆ° localStorageï¼Œå†å¤±è´¥åˆ™ç”¨ DEFAULT */
async function loadContent() {
  try {
    const res = await fetch(
      `${SUPABASE_URL}/rest/v1/site_content?id=eq.1&select=content`,
      { headers: { 'apikey': SUPABASE_KEY, 'Authorization': `Bearer ${SUPABASE_KEY}` } }
    );
    const rows = await res.json();
    if (rows?.[0]?.content && Object.keys(rows[0].content).length > 0) {
      const remote = mergeWithDefault(DEFAULT, rows[0].content);
      localStorage.setItem(STORAGE_KEY, JSON.stringify(remote)); // æœ¬åœ°ç¼“å­˜
      return remote;
    }
  } catch { /* ç½‘ç»œå¼‚å¸¸ï¼Œé™çº§ */ }
  // é™çº§åˆ° localStorage
  const cached = localStorage.getItem(STORAGE_KEY);
  if (cached) {
    try {
      const parsed = JSON.parse(cached);
      if (Object.keys(parsed).length > 0) return parsed; // å¿½ç•¥ç©ºå¯¹è±¡ç¼“å­˜
    } catch {}
  }
  return JSON.parse(JSON.stringify(DEFAULT));
}

/* ä¿å­˜åˆ° Supabaseï¼ŒåŒæ—¶æ›´æ–° localStorage ç¼“å­˜ */
async function persistContent(data) {
  localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
  try {
    const res = await fetch(`${SUPABASE_URL}/rest/v1/site_content`, {
      method: 'POST',
      headers: {
        'apikey': SUPABASE_KEY,
        'Authorization': `Bearer ${SUPABASE_KEY}`,
        'Content-Type': 'application/json',
        'Prefer': 'resolution=merge-duplicates,return=representation',
      },
      body: JSON.stringify({ id: 1, content: data, updated_at: new Date().toISOString() }),
    });
    if (!res.ok) return false;
    const rows = await res.json();
    // è‹¥ RLS é˜»æ–­å†™å…¥ï¼Œrows ä¸ºç©ºæ•°ç»„ï¼Œè¿”å› false æ˜¾ç¤ºæ©™è‰²è­¦å‘Š
    return Array.isArray(rows) && rows.length > 0;
  } catch { return false; }
}

/* å½“å‰å†…å®¹çš„å†…å­˜ç¼“å­˜ï¼ˆinit åå¡«å…¥ï¼Œé¿å…æ¯æ¬¡ä¿å­˜éƒ½é‡æ–°è¯·æ±‚ï¼‰ */
let _content = null;
function getContent() {
  if (_content && Object.keys(_content).length > 0) return _content;
  return JSON.parse(JSON.stringify(DEFAULT));
}

/* â”€â”€ Auth â”€â”€ */
function isLoggedIn() { return sessionStorage.getItem(AUTH_KEY) === '1'; }

$('loginBtn').addEventListener('click', doLogin);
$('pwdInput').addEventListener('keydown', e => { if (e.key === 'Enter') doLogin(); });

function doLogin() {
  const pw = $('pwdInput').value;
  if (pw === PASSWORD) {
    sessionStorage.setItem(AUTH_KEY, '1');
    $('loginScreen').style.display = 'none';
    $('cmsApp').style.display = 'block';
    initCMS();
  } else {
    $('loginError').style.display = 'block';
    $('pwdInput').value = '';
    $('pwdInput').focus();
  }
}

$('logoutBtn').addEventListener('click', () => {
  sessionStorage.removeItem(AUTH_KEY);
  location.reload();
});

/* â”€â”€ Navigation â”€â”€ */
const SECTION_META = {
  dashboard:    { title: 'ä»ªè¡¨ç›˜',   desc: 'å†…å®¹æ€»è§ˆä¸å¿«é€Ÿæ“ä½œ' },
  nav:          { title: 'å¯¼èˆªæ ',   desc: 'å“ç‰Œåç§°ä¸æ ‡è¯†è®¾ç½®' },
  hero:         { title: 'é¦–é¡µæ¨ªå¹…', desc: 'Hero åŒºåŸŸå…¨éƒ¨æ–‡å­—å†…å®¹' },
  about:        { title: 'å…³äºæˆ‘ä»¬', desc: 'å…¬å¸ä»‹ç»æ–‡å­—' },
  services:     { title: 'æœåŠ¡é¡¹ç›®', desc: '6 ä¸ªæœåŠ¡å¡ç‰‡' },
  work:         { title: 'ç²¾é€‰æ¡ˆä¾‹', desc: '3 ä¸ªä½œå“å±•ç¤º' },
  testimonials: { title: 'å®¢æˆ·å£ç¢‘', desc: '3 æ¡è¯„ä»·' },
  cta:          { title: 'CTA åŒºåŸŸ', desc: 'å·å¬è¡ŒåŠ¨åŒºå—' },
  contact:      { title: 'è”ç³»æ–¹å¼', desc: 'é‚®ç®±ã€ç”µè¯ã€åœ°å€' },
  footer:       { title: 'é¡µè„šè®¾ç½®', desc: 'å£å·ä¸ç‰ˆæƒä¿¡æ¯' },
};

function showSection(id) {
  document.querySelectorAll('.cms-section').forEach(s => s.classList.remove('active'));
  document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
  const sec = document.getElementById('section-' + id);
  if (sec) sec.classList.add('active');
  const nav = document.querySelector(`.nav-item[data-section="${id}"]`);
  if (nav) nav.classList.add('active');
  const meta = SECTION_META[id] || {};
  $('headerTitle').textContent = meta.title || id;
  $('headerDesc').textContent  = meta.desc  || '';
}

document.querySelectorAll('.nav-item').forEach(el => {
  el.addEventListener('click', () => showSection(el.dataset.section));
});

/* â”€â”€ Build dynamic repeaters â”€â”€ */
function buildServicesRepeater(services) {
  const container = $('services-repeater');
  container.innerHTML = services.map((s, i) => `
    <div class="repeater-item">
      <div class="repeater-item-header"><span>${i+1}</span> æœåŠ¡ ${i+1}</div>
      <div class="ri-fields">
        <div class="form-group"><label>å›¾æ ‡ç¬¦å·</label>
          <input type="text" id="svc-icon-${i}" value="${s.icon}" maxlength="4" /></div>
        <div class="form-group"><label>æ ‡é¢˜</label>
          <input type="text" id="svc-title-${i}" value="${s.title}" /></div>
        <div class="form-group"><label>æè¿°</label>
          <textarea id="svc-desc-${i}" rows="3">${s.desc}</textarea></div>
      </div>
    </div>
  `).join('');
}

/* HTML å±æ€§å€¼è½¬ä¹‰ï¼Œé˜²æ­¢å¼•å·ç ´åç»“æ„ */
function escAttr(str) {
  return String(str || '').replace(/&/g, '&amp;').replace(/"/g, '&quot;');
}

function buildWorkRepeater(work) {
  const container = $('work-repeater');
  const canDelete = work.length > 1;
  container.innerHTML = work.map((w, i) => `
    <div class="repeater-item">
      <div class="repeater-item-header">
        <span>${i+1}</span> æ¡ˆä¾‹ ${i+1}
        ${canDelete ? `<button class="item-del-btn" onclick="deleteWorkItem(${i})">âœ• åˆ é™¤</button>` : ''}
      </div>
      <div class="ri-fields">
        <div class="form-group"><label>æ ‡ç­¾</label>
          <input type="text" id="work-tag-${i}" value="${escAttr(w.tag)}" /></div>
        <div class="form-group"><label>æ ‡é¢˜</label>
          <input type="text" id="work-title-${i}" value="${escAttr(w.title)}" /></div>
        <div class="form-group"><label>æè¿°</label>
          <input type="text" id="work-desc-${i}" value="${escAttr(w.desc)}" /></div>
        <div class="form-group"><label>å›¾ç‰‡ URL</label>
          <input type="text" id="work-image-${i}" value="${escAttr(w.image || '')}" placeholder="https://..." /></div>
      </div>
    </div>
  `).join('');
}

/* è¯»å–å½“å‰ DOM ä¸­æ‰€æœ‰æ¡ˆä¾‹çš„å€¼ */
function getWorkItemsFromDOM() {
  const items = [];
  let i = 0;
  while (document.getElementById(`work-tag-${i}`)) {
    items.push({
      tag:   document.getElementById(`work-tag-${i}`).value.trim(),
      title: document.getElementById(`work-title-${i}`).value.trim(),
      desc:  document.getElementById(`work-desc-${i}`).value.trim(),
      image: document.getElementById(`work-image-${i}`)?.value.trim() || '',
    });
    i++;
  }
  return items;
}

/* æ–°å¢ä¸€æ¡ç©ºæ¡ˆä¾‹ */
function addWorkItem() {
  const current = getWorkItemsFromDOM();
  current.push({ tag: '', title: '', desc: '' });
  buildWorkRepeater(current);
  // æ»šåŠ¨åˆ°æ–°æ¡ç›®
  const last = $('work-repeater').lastElementChild;
  if (last) last.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
  last?.querySelector('input')?.focus();
}

/* åˆ é™¤æŒ‡å®šç´¢å¼•çš„æ¡ˆä¾‹ */
function deleteWorkItem(index) {
  const current = getWorkItemsFromDOM();
  if (current.length <= 1) return; // è‡³å°‘ä¿ç•™ä¸€æ¡ï¼ŒæŒ‰é’®å·²éšè—ä½†åšåŒé‡ä¿æŠ¤
  current.splice(index, 1);
  buildWorkRepeater(current);
}

function buildTestimonialsRepeater(testimonials) {
  const container = $('testimonials-repeater');
  container.innerHTML = testimonials.map((t, i) => `
    <div class="repeater-item">
      <div class="repeater-item-header"><span>${i+1}</span> è¯„ä»· ${i+1}</div>
      <div class="ri-fields">
        <div class="form-group"><label>è¯„ä»·å†…å®¹</label>
          <textarea id="testi-text-${i}" rows="4">${t.text}</textarea></div>
        <div class="form-grid" style="gap:10px">
          <div class="form-group"><label>å§“å</label>
            <input type="text" id="testi-author-${i}" value="${t.author}" /></div>
          <div class="form-group"><label>èŒä½/å…¬å¸</label>
            <input type="text" id="testi-role-${i}" value="${t.role}" /></div>
          <div class="form-group"><label>å¤´åƒå­—æ¯</label>
            <input type="text" id="testi-initial-${i}" value="${t.initial}" maxlength="2" /></div>
        </div>
      </div>
    </div>
  `).join('');
}

/* â”€â”€ Populate all forms â”€â”€ */
function populateForms(c) {
  // Nav
  setVal('nav-logo', c.nav.logo);
  setVal('nav-logoMark', c.nav.logoMark);
  // Hero
  setVal('hero-badge', c.hero.badge);
  setVal('hero-headline1', c.hero.headline1);
  setVal('hero-headline2', c.hero.headline2);
  setVal('hero-sub', c.hero.sub);
  setVal('hero-cta1', c.hero.cta1);
  setVal('hero-cta2', c.hero.cta2);
  setVal('hero-stat1Num',   c.hero.stat1Num);
  setVal('hero-stat1Sym',   c.hero.stat1Sym);
  setVal('hero-stat1Label', c.hero.stat1Label);
  setVal('hero-stat2Num',   c.hero.stat2Num);
  setVal('hero-stat2Sym',   c.hero.stat2Sym);
  setVal('hero-stat2Label', c.hero.stat2Label);
  setVal('hero-stat3Num',   c.hero.stat3Num);
  setVal('hero-stat3Sym',   c.hero.stat3Sym);
  setVal('hero-stat3Label', c.hero.stat3Label);
  // About
  setVal('about-cardTitle', c.about.cardTitle);
  setVal('about-cardText',  c.about.cardText);
  setVal('about-years',     c.about.years);
  setVal('about-title1',    c.about.title1);
  setVal('about-title2',    c.about.title2);
  setVal('about-body1',     c.about.body1);
  setVal('about-body2',     c.about.body2);
  // Services repeater
  buildServicesRepeater(c.services);
  // Work repeater
  buildWorkRepeater(c.work);
  // Testimonials repeater
  buildTestimonialsRepeater(c.testimonials);
  // CTA
  setVal('cta-title', c.cta.title);
  setVal('cta-sub',   c.cta.sub);
  setVal('cta-btn',   c.cta.btn);
  // Contact
  setVal('contact-title',   c.contact.title);
  setVal('contact-sub',     c.contact.sub);
  setVal('contact-email',   c.contact.email);
  setVal('contact-phone',   c.contact.phone);
  setVal('contact-address', c.contact.address);
  // Footer
  setVal('footer-tagline', c.footer.tagline);
  setVal('footer-year',    c.footer.year);
  setVal('footer-company', c.footer.company);
}

/* â”€â”€ Section save functions â”€â”€ */
async function saveSection(section) {
  const c = getContent();
  switch (section) {
    case 'nav':
      c.nav.logo = val('nav-logo');
      c.nav.logoMark = val('nav-logoMark');
      break;
    case 'hero':
      c.hero.badge      = val('hero-badge');
      c.hero.headline1  = val('hero-headline1');
      c.hero.headline2  = val('hero-headline2');
      c.hero.sub        = val('hero-sub');
      c.hero.cta1       = val('hero-cta1');
      c.hero.cta2       = val('hero-cta2');
      c.hero.stat1Num   = parseInt(val('hero-stat1Num')) || 0;
      c.hero.stat1Sym   = val('hero-stat1Sym');
      c.hero.stat1Label = val('hero-stat1Label');
      c.hero.stat2Num   = parseInt(val('hero-stat2Num')) || 0;
      c.hero.stat2Sym   = val('hero-stat2Sym');
      c.hero.stat2Label = val('hero-stat2Label');
      c.hero.stat3Num   = parseInt(val('hero-stat3Num')) || 0;
      c.hero.stat3Sym   = val('hero-stat3Sym');
      c.hero.stat3Label = val('hero-stat3Label');
      break;
    case 'about':
      c.about.cardTitle = val('about-cardTitle');
      c.about.cardText  = val('about-cardText');
      c.about.years     = parseInt(val('about-years')) || 8;
      c.about.title1    = val('about-title1');
      c.about.title2    = val('about-title2');
      c.about.body1     = val('about-body1');
      c.about.body2     = val('about-body2');
      break;
    case 'services':
      c.services = c.services.map((_, i) => ({
        icon:  document.getElementById(`svc-icon-${i}`)?.value.trim()  || '',
        title: document.getElementById(`svc-title-${i}`)?.value.trim() || '',
        desc:  document.getElementById(`svc-desc-${i}`)?.value.trim()  || '',
      }));
      break;
    case 'work':
      c.work = getWorkItemsFromDOM();
      break;
    case 'testimonials':
      c.testimonials = c.testimonials.map((_, i) => ({
        text:    document.getElementById(`testi-text-${i}`)?.value.trim()    || '',
        author:  document.getElementById(`testi-author-${i}`)?.value.trim()  || '',
        role:    document.getElementById(`testi-role-${i}`)?.value.trim()    || '',
        initial: document.getElementById(`testi-initial-${i}`)?.value.trim() || '',
      }));
      break;
    case 'cta':
      c.cta.title = val('cta-title');
      c.cta.sub   = val('cta-sub');
      c.cta.btn   = val('cta-btn');
      break;
    case 'contact':
      c.contact.title   = val('contact-title');
      c.contact.sub     = val('contact-sub');
      c.contact.email   = val('contact-email');
      c.contact.phone   = val('contact-phone');
      c.contact.address = val('contact-address');
      break;
    case 'footer':
      c.footer.tagline = val('footer-tagline');
      c.footer.year    = val('footer-year');
      c.footer.company = val('footer-company');
      break;
  }
  _content = c;
  const ok = await persistContent(c);
  flashSaved(section, ok);
}

function flashSaved(section, ok = true) {
  const el = document.getElementById('save-' + section);
  if (!el) return;
  el.textContent = ok ? 'âœ“ å·²ä¿å­˜åˆ°äº‘ç«¯' : 'âœ“ å·²ä¿å­˜ï¼ˆæœ¬åœ°ç¼“å­˜ï¼Œç½‘ç»œå¼‚å¸¸ï¼‰';
  el.style.color  = ok ? '#4ade80' : '#fb923c';
  el.classList.add('visible');
  setTimeout(() => el.classList.remove('visible'), 3000);
}

/* â”€â”€ Reset all â”€â”€ */
async function resetAll() {
  if (!confirm('ç¡®å®šè¦é‡ç½®æ‰€æœ‰å†…å®¹ä¸ºé»˜è®¤å€¼å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ã€‚')) return;
  const def = JSON.parse(JSON.stringify(DEFAULT));
  _content = def;
  await persistContent(def);
  populateForms(def);
  alert('å†…å®¹å·²é‡ç½®ä¸ºé»˜è®¤å€¼ã€‚');
}

/* â”€â”€ Init â”€â”€ */
async function initCMS() {
  _content = await loadContent();
  populateForms(_content);
}

/* â”€â”€ Boot â”€â”€ */
if (isLoggedIn()) {
  $('loginScreen').style.display = 'none';
  $('cmsApp').style.display = 'block';
  initCMS();
}
</script>
</body>
</html>
